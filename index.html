<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>SLEEEEEEEEEEP City Intro</title>
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="SLEEEEP">
<meta name="theme-color" content="#111111">

<style>
  *{
    box-sizing:border-box;
    margin:0;
    padding:0;
  }
  html,body{
    height:100%;
  }
  body{
    font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
    background:#bfc0c2;
    display:flex;
    justify-content:center;
    align-items:center;

    -webkit-user-select:none;
    user-select:none;
    -webkit-touch-callout:none;
    -webkit-tap-highlight-color:transparent;
  }

  /* 세로 모드 안내 */
  .rotate-warning{
    position:fixed;
    inset:0;
    display:none;
    align-items:center;
    justify-content:center;
    background:#000;
    color:#fff;
    text-align:center;
    padding:20px;
    z-index:1000;
    font-size:18px;
  }
  @media (orientation:portrait){
    .rotate-warning{display:flex;}
    .game-shell{display:none;}
  }

  /* ===== 팝업 게임 창 ===== */
  .game-shell{
    width:100vw;
    height:100vh;
    display:flex;
    align-items:center;
    justify-content:center;
  }
  .game-popup{
    position:relative;
    width:92vw;
    max-width:900px;
    aspect-ratio:4/3;
    background:#d0d2d4;
    border-radius:16px;
    box-shadow:0 0 40px rgba(0,0,0,0.9);
    overflow:hidden;
    border:4px solid #111;
  }
  .game-root{
    position:absolute;
    inset:0;
    background:#d0d2d4;
    image-rendering:pixelated;
    overflow:hidden;
  }

  /* ===== 도시 배경 (빌딩) ===== */
  .city{
    position:absolute;
    left:0;
    right:0;
    top:0;
    height:55%;
    overflow:hidden;
    background:#c3c4c6;
  }

  /* 빌딩 실루엣 */
  .city::before{
    content:"";
    position:absolute;
    inset:0;
    background:
      /* 뒤쪽 회색/카키 빌딩 */
      repeating-linear-gradient(
        to right,
        #8d8e8f 0 26px,
        #8d8e8f 26px 52px,
        transparent 52px 60px
      ),
      repeating-linear-gradient(
        to right,
        #7a8479 0 30px,
        #7a8479 30px 60px,
        transparent 60px 70px
      ),
      repeating-linear-gradient(
        to right,
        #6b7479 0 26px,
        #6b7479 26px 52px,
        transparent 52px 60px
      );
    background-size:
      220px 100%,
      260px 90%,
      200px 80%;
    background-position:
      0 12%,
      0 25%,
      0 35%;
    animation: cityScroll 35s linear infinite;
  }

  /* 격자형 창문 느낌 */
  .city::after{
    content:"";
    position:absolute;
    inset:10% 0 0 0;
    background:
      repeating-linear-gradient(
        to right,
        transparent 0 8px,
        rgba(255,255,255,0.2) 8px 10px
      ),
      repeating-linear-gradient(
        to bottom,
        transparent 0 8px,
        rgba(255,255,255,0.2) 8px 10px
      );
    mix-blend-mode:soft-light;
    opacity:0.6;
    pointer-events:none;
  }

  @keyframes cityScroll{
    0%{ background-position:0 12%,0 25%,0 35%; }
    100%{ background-position:-260px 12%,-220px 25%,-200px 35%; }
  }

  /* ===== 수풀 라인 ===== */
  .bushes{
    position:absolute;
    left:0;
    right:0;
    top:50%;
    height:12%;
    background:
      repeating-linear-gradient(
        to right,
        #0b3410 0 8px,
        #0b3410 8px 12px,
        #134c18 12px 18px,
        #1b6a21 18px 24px
      );
    box-shadow:0 -4px 0 rgba(0,0,0,0.5);
  }

  /* ===== 도로 ===== */
  .road{
    position:absolute;
    left:0;
    right:0;
    bottom:0;
    height:38%;
    background:#7a7a7d;
    border-top:8px solid #666;
    box-shadow:0 -4px 0 #444 inset;
  }

  /* 지그재그 하얀 경계 */
  .road::before,
  .road::after{
    content:"";
    position:absolute;
    left:0;
    right:0;
    height:10px;
    background:
      repeating-linear-gradient(
        to right,
        #f5f5f5 0 8px,
        #f5f5f5 8px 16px,
        transparent 16px 24px
      );
  }
  .road::before{
    top:8%;
  }
  .road::after{
    bottom:8%;
  }

  /* 차선 */
  .lane{
    position:absolute;
    left:0;
    right:0;
    height:6px;
    background:
      repeating-linear-gradient(
        to right,
        transparent 0 32px,
        #fdfdfd 32px 52px
      );
  }
  .lane.mid{ top:40%; }
  .lane.low{ top:68%; }

  /* ===== 자동차 ===== */
  .car{
    position:absolute;
    bottom:22%;
    width:34px;
    height:22px;
    background:#ffcb40;
    border-radius:6px 6px 4px 4px;
    border:3px solid #333;
    box-shadow:0 3px 0 rgba(0,0,0,0.6);
    image-rendering:pixelated;
    animation: carMove 5s linear infinite;
  }
  .car::before,
  .car::after{
    content:"";
    position:absolute;
    bottom:-7px;
    width:12px;
    height:12px;
    border-radius:50%;
    background:#111;
  }
  .car::before{ left:3px; }
  .car::after{ right:3px; }

  .car.back{
    bottom:12%;
    transform:scale(0.9);
    animation-duration:6s;
    animation-delay:-2s;
  }

  @keyframes carMove{
    0%{ transform:translateX(-40px) scale(var(--scale,1)); }
    100%{ transform:translateX(110%) scale(var(--scale,1)); }
  }

  /* ===== 타이틀 & 버튼 ===== */
  .title-screen{
    position:absolute;
    inset:0;
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    background:linear-gradient(to bottom,rgba(0,0,0,0.2),rgba(0,0,0,0.85));
    color:#ffffff;
    text-align:center;
    padding:20px;
    z-index:10;
  }
  .title-lines{
    font-family:monospace;
    font-size:clamp(18px,3.4vmin,28px);
    letter-spacing:0.08em;
    line-height:1.7;
    text-shadow:0 3px 0 rgba(0,0,0,0.9);
    margin-bottom:28px;
  }
  .title-lines span{
    display:block;
  }
  .btn{
    display:inline-block;
    padding:10px 30px;
    border-radius:999px;
    border:3px solid #111;
    background:#f3c86c;
    color:#111;
    font-weight:600;
    font-size:16px;
    box-shadow:0 4px 0 #111;
    cursor:pointer;
  }
  .btn:active{
    transform:translateY(2px);
    box-shadow:0 2px 0 #111;
  }

  /* ===== 대화 상자 (타자 효과) ===== */
  .dialog-layer{
    position:absolute;
    left:50%;
    bottom:6%;
    transform:translateX(-50%);
    width:90%;
    max-width:640px;
    padding:12px 16px;
    background:rgba(15,16,20,0.97);
    border:3px solid #ffffff;
    box-shadow:0 4px 0 rgba(0,0,0,0.8);
    border-radius:10px;
    display:none;
    align-items:center;
    justify-content:space-between;
    gap:12px;
    color:#f5f5f5;
    font-size:15px;
    font-family:monospace;
  }
  .dialog-text{
    flex:1;
    text-align:left;
    min-height:1.4em;
    white-space:pre-wrap;
  }
  .dialog-btn{
    flex-shrink:0;
    padding:6px 12px;
    border-radius:8px;
    border:2px solid #fff;
    background:#f0ad4b;
    color:#111;
    font-size:13px;
    font-weight:600;
    cursor:pointer;
    box-shadow:0 3px 0 rgba(0,0,0,0.8);
    white-space:nowrap;
  }
  .dialog-btn:active{
    transform:translateY(1px);
    box-shadow:0 1px 0 rgba(0,0,0,0.8);
  }
</style>
</head>
<body>

<div class="rotate-warning">
  이 게임은 <strong>가로 모드</strong>에서만 사용할 수 있습니다.<br><br>
  기기를 가로로 돌려 주세요.
</div>

<div class="game-shell">
  <div class="game-popup">
    <div class="game-root">

      <!-- 도시 / 수풀 / 도로 / 자동차 -->
      <div class="city"></div>
      <div class="bushes"></div>

      <div class="road">
        <div class="lane mid"></div>
        <div class="lane low"></div>

        <div class="car" style="--scale:1;"></div>
        <div class="car back" style="--scale:0.9;"></div>
      </div>

      <!-- 타이틀 -->
      <div class="title-screen" id="title">
        <div class="title-lines" id="titleText">
          <!-- 여기 타자 효과로 SLEEEEEEEP 찍힘 -->
        </div>
        <button class="btn" id="startBtn">Start</button>
      </div>

      <!-- 대화 상자 -->
      <div class="dialog-layer" id="dialog">
        <div class="dialog-text" id="dialogText"></div>
        <button class="dialog-btn" id="dialogNext">NEXT</button>
      </div>

    </div>
  </div>
</div>

<script>
  // ===== 타이틀 타자 효과 =====
  const titleLines = [
    'SLEEEEEEEEEEP',
    'SLEEEEEEEEEEP',
    'SLEEEEEEEEEEP',
    'SLEEEEEEEEEEP'
  ];
  const titleEl = document.getElementById('titleText');
  let tLine = 0;
  let tChar = 0;

  function typeTitle(){
    if(tLine >= titleLines.length) return;
    const line = titleLines[tLine];
    if(tChar < line.length){
      titleEl.textContent += line[tChar];
      tChar++;
      setTimeout(typeTitle, 60);
    }else{
      titleEl.textContent += '\n';
      tLine++;
      tChar = 0;
      setTimeout(typeTitle, 150);
    }
  }
  typeTitle();

  const startBtn   = document.getElementById('startBtn');
  const dialogLayer= document.getElementById('dialog');
  const dialogText = document.getElementById('dialogText');
  const dialogNext = document.getElementById('dialogNext');

  const lines = [
    '안녕?',
    '여행은 어때?',
    '너는 곧 3번째 수면 단계로 진입할 거야.',
    '우선 어디 편한 곳에 자리를 잡고 앉아봐.'
  ];
  let idx = 0;
  let typing = false;

  function typeLine(text){
    dialogText.textContent = '';
    typing = true;
    dialogNext.disabled = true;
    dialogNext.style.opacity = 0.5;

    let i = 0;
    const speed = 55;
    const timer = setInterval(()=>{
      dialogText.textContent += text[i];
      i++;
      if(i >= text.length){
        clearInterval(timer);
        typing = false;
        dialogNext.disabled = false;
        dialogNext.style.opacity = 1;

        if(idx === lines.length - 1){
          dialogNext.textContent = 'OK';
        }else{
          dialogNext.textContent = 'NEXT';
        }
      }
    }, speed);
  }

  function showLine(i){
    dialogLayer.style.display = 'flex';
    typeLine(lines[i]);
  }

  startBtn.addEventListener('click', () => {
    document.getElementById('title').style.background = 'none';
    // 타이틀 문장 유지한 채로 대화 시작
    idx = 0;
    showLine(idx);
  });

  dialogNext.addEventListener('click', () => {
    if(typing) return;
    idx++;
    if(idx < lines.length){
      showLine(idx);
    }else{
      dialogNext.disabled = true;
      dialogNext.style.opacity = 0.5;
    }
  });
</script>

</body>
</html>