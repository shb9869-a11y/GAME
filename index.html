<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport"
        content="width=device-width, initial-scale=1, viewport-fit=cover, user-scalable=no" />
  <title>SLEEP CITY</title>

  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="SLEEP CITY">
  <meta name="theme-color" content="#000000">

  <style>
    :root{
      --window-on: #ffd800;
      --window-off: #000000;
      --text: #f5f5f5;
      --sky: #050509;
    }

    *{margin:0;padding:0;box-sizing:border-box;}

    html,body{
      width:100%;
      height:100%;
      overflow:hidden;
      background:#000;
      color:var(--text);
      font-family:-apple-system,BlinkMacSystemFont,"Apple SD Gothic Neo",system-ui,sans-serif;
    }

    /* ì„¸ë¡œëª¨ë“œ ê²½ê³  */
    .rotate-warning{
      position:fixed;
      inset:0;
      background:#000;
      color:#fff;
      display:none;
      align-items:center;
      justify-content:center;
      z-index:999;
      text-align:center;
      padding:24px;
      font-size:14px;
      line-height:1.6;
    }
    @media (orientation:portrait){
      .rotate-warning{display:flex;}
    }

    body{
      display:flex;
      align-items:center;
      justify-content:center;
    }

    .app{
      width:100%;
      height:100%;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      padding:16px 24px 24px;
      gap:16px;
    }

    /* ì¤‘ì•™ ê±´ë¬¼ ì°½ (í•˜ì–€ í…Œë‘ë¦¬ ì œê±°) */
    .city-shell{
      width:70vw;
      max-width:820px;
      height:55vh;
      max-height:420px;
      display:flex;
      align-items:center;
      justify-content:center;
    }

    .city-window{
      width:100%;
      height:100%;
      background:var(--sky);
      position:relative;
      overflow:hidden;
      image-rendering:pixelated;
      box-shadow:0 0 20px rgba(0,0,0,0.9);
    }

    /* ì´ˆìŠ¹ë‹¬ (ì™¼ìª½ ìœ„) */
    .moon{
      position:absolute;
      width:28px;
      height:28px;
      top:10px;
      left:14px;
      border-radius:50%;
      background:#fdfdfd;
    }
    .moon::after{
      content:"";
      position:absolute;
      width:24px;
      height:24px;
      top:3px;
      left:7px;
      border-radius:50%;
      background:var(--sky);
    }

    .city-layers{
      position:absolute;
      inset:0;
    }

    .layer{
      position:absolute;
      left:6px;
      right:6px;
      display:flex;
      align-items:flex-end;
      justify-content:space-between;
      gap:6px; /* ê±´ë¬¼ ì‚¬ì´ ê°„ê²© */
      pointer-events:none;
    }
    .layer-back{
      bottom:26%;
      transform:scale(0.9);
      opacity:0.6;
    }
    .layer-mid{
      bottom:13%;
      transform:scale(0.96);
      opacity:0.8;
    }
    .layer-front{
      bottom:0;
      opacity:1;
    }

    /* ê±´ë¬¼: ë” ì–‡ê²Œ */
    .building{
      position:relative;
      display:flex;
      flex-direction:column;
      padding:4px 2px 6px;
      border:1px solid rgba(0,0,0,0.7);
      box-shadow:0 -2px 0 rgba(255,255,255,0.04) inset;
      image-rendering:pixelated;
      flex:0.2;           /* ê¸°ë³¸ ë‘ê»˜ */
      max-width:8%;       /* ë„ˆë¬´ ëš±ëš±í•´ì§€ì§€ ì•Šê²Œ ì œí•œ */
      min-width:4%;
    }

    /* ì§€ë¶• (ê¼­ì§“ì  í™•ì‹¤í•˜ê²Œ) */
    .roof{
      width:90%;
      margin:0 auto 4px;
    }
    .roof-flat{
      height:4px;
      background:rgba(255,255,255,0.12);
    }
    .roof-tri{
      width:0;
      height:0;
      border-left:10px solid transparent;
      border-right:10px solid transparent;
      border-bottom:14px solid rgba(240,240,240,0.85);
    }
    .roof-step{
      height:10px;
      background:#dcdcdc;
      clip-path:polygon(
        0 100%, 0 35%,
        30% 35%, 30% 0,
        70% 0, 70% 35%,
        100% 35%, 100% 100%
      );
    }

    /* ì°½ë¬¸ */
    .windows{
      width:100%;
      display:grid;
      grid-template-columns:repeat(2,1fr); /* ê°€ë¡œ ë‘ ê°œ ìœ ì§€ */
      grid-auto-rows:8px;
      gap:3px;
      padding:0 2px 2px;
    }

    .window{
      width:100%;
      height:100%;
      background:var(--window-on);
      box-shadow:0 0 4px rgba(255,216,0,0.6);
      transition:background 2s linear, box-shadow 2s linear; /* ğŸ”¥ 2ì´ˆ í˜ì´ë“œ */
    }
    body.lights-off .window{
      background:var(--window-off);
      box-shadow:none;
    }

    /* í•˜ë‹¨ UI */
    .bottom-ui{
      width:70vw;
      max-width:820px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:16px;
    }

    /* ì™¼ìª½ ì•„ë˜ ì›€ì§ì„ ì»¤ì„œ */
    .cursor-pad{
      display:flex;
      flex-direction:column;
      gap:4px;
      align-items:center;
      justify-content:center;
      font-size:12px;
    }
    .cursor-row{
      display:flex;
      gap:4px;
    }
    .cursor-btn{
      width:30px;
      height:30px;
      border:1px solid #777;
      background:#050505;
      color:#f5f5f5;
      font-size:14px;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:0;
      cursor:pointer;
    }
    .cursor-btn:active{
      background:#111;
    }

    /* ê°€ìš´ë° Start ë²„íŠ¼ â€“ ë” ê¹”ë”í•˜ê²Œ */
    .start-btn{
      padding:10px 30px;
      border:1px solid #f5f5f5;
      background:#101010;
      color:#f5f5f5;
      font-size:13px;
      letter-spacing:0.18em;
      text-transform:uppercase;
      cursor:pointer;
      outline:none;
      min-width:130px;
    }
    .start-btn:active{
      background:#181818;
      transform:translateY(1px);
    }
    .start-btn[disabled]{
      opacity:0.6;
      cursor:default;
    }

    /* ì˜¤ë¥¸ìª½ ì•„ë˜ ë²„íŠ¼ */
    .side-btn{
      width:40px;
      height:40px;
      border:1px solid #777;
      background:#050505;
      color:#f5f5f5;
      cursor:pointer;
      font-size:16px;
      display:flex;
      align-items:center;
      justify-content:center;
      outline:none;
    }
    .side-btn:active{
      background:#111;
    }

    .status-label{
      width:70vw;
      max-width:820px;
      font-size:11px;
      opacity:0.7;
      text-align:center;
      margin-top:-4px;
    }
  </style>
</head>
<body>
  <div class="rotate-warning">
    í™”ë©´ì„ ê°€ë¡œ ëª¨ë“œë¡œ ëŒë ¤ì£¼ì„¸ìš”.<br>
    Please rotate your device to landscape.
  </div>

  <div class="app">
    <!-- ì¤‘ì•™ ê±´ë¬¼ ì°½ -->
    <div class="city-shell">
      <div class="city-window">
        <div class="moon"></div>
        <div class="city-layers">
          <div class="layer layer-back" data-count="13"></div>
          <div class="layer layer-mid" data-count="11"></div>
          <div class="layer layer-front" data-count="9"></div>
        </div>
      </div>
    </div>

    <!-- í•˜ë‹¨ UI: ì¢Œì¸¡ ì»¤ì„œ / ì¤‘ì•™ Start / ìš°ì¸¡ ë²„íŠ¼ -->
    <div class="bottom-ui">
      <div class="cursor-pad">
        <button class="cursor-btn" aria-label="up">â–²</button>
        <div class="cursor-row">
          <button class="cursor-btn" aria-label="left">â—€</button>
          <button class="cursor-btn" aria-label="down">â–¼</button>
          <button class="cursor-btn" aria-label="right">â–¶</button>
        </div>
      </div>

      <button class="start-btn" id="startBtn">START</button>

      <button class="side-btn" aria-label="extra button">â—</button>
    </div>

    <div class="status-label" id="statusLabel">LIGHT: ON</div>
  </div>

  <script>
    // íšŒìƒ‰ ê³„ì—´ íŒ”ë ˆíŠ¸
    const palette = [
      "#16171b","#1b1c22","#20232a",
      "#252831","#2b3038","#313640",
      "#373c46","#1b1c20","#22252c"
    ];

    function makeBuilding(layerName, i){
      const b = document.createElement("div");
      b.className = "building";

      // ë ˆì´ì–´ë³„ ê¸°ë³¸ ë†’ì´
      const base = layerName === "back" ? 55 : (layerName === "mid" ? 45 : 35);
      const h = base + (i * 4) % 22;
      b.style.height = h + "%";

      // ë‘ê»˜ ì¡°ê¸ˆì”© ë‹¤ë¥´ê²Œ
      const flexVal = 0.18 + (i % 4) * 0.04; // 0.18 ~ 0.30
      b.style.flex = flexVal.toFixed(2);

      // ìƒ‰ìƒ (íšŒìƒ‰ ê³„ì—´)
      const color = palette[(i * 2 + (layerName === "front" ? 1 : 0)) % palette.length];
      b.style.background = color;

      // ì§€ë¶•
      const roof = document.createElement("div");
      roof.classList.add("roof");
      const rt = i % 3;
      if(rt === 0) roof.classList.add("roof-flat");
      else if(rt === 1) roof.classList.add("roof-tri");
      else roof.classList.add("roof-step");
      b.appendChild(roof);

      // ì°½ë¬¸
      const windows = document.createElement("div");
      windows.className = "windows";
      const floors = 6 + (i % 4);
      for(let k=0;k<floors*2;k++){
        const w = document.createElement("div");
        w.className = "window";

        // ëª‡ëª‡ì€ ë¯¸ë¦¬ êº¼ì§„ ì°½
        if(Math.random() < 0.1){
          w.style.background = "#000";
          w.style.boxShadow = "none";
        }
        windows.appendChild(w);
      }
      b.appendChild(windows);

      return b;
    }

    // ë ˆì´ì–´ ì±„ìš°ê¸°
    document.querySelectorAll(".layer").forEach(layer=>{
      const count = Number(layer.dataset.count);
      const name =
        layer.classList.contains("layer-back") ? "back" :
        layer.classList.contains("layer-mid") ? "mid" : "front";
      for(let i=0;i<count;i++){
        layer.appendChild(makeBuilding(name,i));
      }
    });

    // Start ë²„íŠ¼: 2ì´ˆ í˜ì´ë“œë¡œ ë¶ˆ ë„ê¸°
    const startBtn = document.getElementById("startBtn");
    const statusLabel = document.getElementById("statusLabel");
    let lightsOff = false;

    startBtn.addEventListener("click", ()=>{
      if(lightsOff) return;
      document.body.classList.add("lights-off");
      lightsOff = true;
      startBtn.disabled = true;
      startBtn.textContent = "OFF";
      statusLabel.textContent = "LIGHT: OFF (2s fade)";
    });

    // ì»¤ì„œ/ì˜¤ë¥¸ìª½ ë²„íŠ¼ì€ ì§€ê¸ˆì€ ê¸°ëŠ¥ ì—†ìŒ (UIë§Œ)
  </script>
</body>
</html>