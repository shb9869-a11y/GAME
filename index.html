<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport"
        content="width=device-width,initial-scale=1,viewport-fit=cover,user-scalable=no,interactive-widget=resizes-content">
  <title>PIXEL RABBIT TEST</title>

  <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap">

  <style>
    *{
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html, body{
      width: 100%;
      height: 100%;
      background: #000;
      color: #f5f5f5;
      font-family: "Press Start 2P", system-ui, sans-serif;
      overscroll-behavior: none;
      -webkit-font-smoothing: antialiased;
      image-rendering: pixelated;
    }

    body{
      display: flex;
      align-items: center;
      justify-content: center;
    }

    #frame{
      width: min(100vw - 32px, 640px);
      height: min(100vh - 32px, 360px);
      border: 2px solid #555;
      background: radial-gradient(circle at 50% 0%, #111 0, #020202 60%);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    #game-wrapper{
      width: 90%;
      aspect-ratio: 16 / 9;
      border: 1px solid #444;
      background: #000;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      overflow: hidden;
    }

    #game-canvas{
      width: 100%;
      height: 100%;
      image-rendering: pixelated;
      background: #000;
      display: block;
    }

    #label{
      position: absolute;
      left: 8px;
      top: 8px;
      font-size: 8px;
      color: #e5e7eb;
      text-shadow: 0 1px 0 #000;
    }

    #help{
      position: absolute;
      left: 8px;
      bottom: 8px;
      font-size: 8px;
      color: #d4d4d4;
      text-shadow: 0 1px 0 #000;
    }

    #toggle{
      position: absolute;
      right: 8px;
      top: 8px;
      font-size: 8px;
      padding: 4px 8px;
      border-radius: 999px;
      border: 1px solid #555;
      background: #111;
      color: #e5e7eb;
      cursor: pointer;
    }
    #toggle:active{
      background: #222;
    }
  </style>
</head>
<body>
  <div id="frame">
    <div id="game-wrapper">
      <canvas id="game-canvas" width="320" height="180"></canvas>
      <div id="label">PIXEL RABBIT</div>
      <div id="help">← → ↑ ↓ : MOVE  |  버튼: 토끼 타입 변경</div>
      <button id="toggle">RED</button>
    </div>
  </div>

<script>
/* =========================
   기본 세팅
   ========================= */
const canvas = document.getElementById('game-canvas');
const ctx    = canvas.getContext('2d');
const toggleBtn = document.getElementById('toggle');

const WIDTH  = canvas.width;
const HEIGHT = canvas.height;

let lastTime = 0;

const RABBIT = {
  x: WIDTH/2,
  y: HEIGHT/2 + 10,
  speed: 80,
  mode: 'red' // 'red' | 'mono'
};

/* =========================
   토끼 드로잉 함수들
   ========================= */

/**
 * 빨간 토끼 (원래 쓰던 스타일)
 * ctx: 2D context
 * x, y: 기준 위치 (좌상단 느낌)
 * scale: 크기 배율
 */
function drawRedRabbit(ctx, x, y, scale = 1){
  const s = 8 * scale;
  ctx.fillStyle = '#ff3333';

  // 머리
  ctx.fillRect(x + 2*scale, y + 1*scale, 4*scale, 3*scale);

  // 귀 2개
  ctx.fillRect(x + 1*scale, y - 1*scale, 1*scale, 3*scale);
  ctx.fillRect(x + 4*scale, y - 1*scale, 1*scale, 3*scale);

  // 몸통
  ctx.fillRect(x + 2*scale, y + 4*scale, 4*scale, 3*scale);

  // 꼬리
  ctx.fillRect(x + 6*scale, y + 4*scale, 2*scale, 2*scale);
}

/**
 * 흑백 토끼 (미로용 흑백 구조에 맞는 버전)
 */
function drawMonoRabbit(ctx, x, y, scale = 1){
  const s = 8 * scale;
  ctx.fillStyle = '#f5f5f5';

  // 머리
  ctx.fillRect(x + 2*scale, y + 1*scale, 4*scale, 3*scale);

  // 귀 (조금 더 각진 느낌)
  ctx.fillRect(x + 1*scale, y - 1*scale, 1*scale, 3*scale);
  ctx.fillRect(x + 5*scale, y - 1*scale, 1*scale, 3*scale);

  // 몸통
  ctx.fillRect(x + 3*scale, y + 4*scale, 3*scale, 4*scale);

  // 다리
  ctx.fillRect(x + 2*scale, y + 7*scale, 1*scale, 2*scale);
  ctx.fillRect(x + 5*scale, y + 7*scale, 1*scale, 2*scale);

  // 꼬리 (살짝 회색)
  ctx.fillStyle = '#d4d4d4';
  ctx.fillRect(x + 6*scale, y + 4*scale, 2*scale, 2*scale);
}

/* =========================
   키보드 입력
   ========================= */
const keys = {
  ArrowLeft:  false,
  ArrowRight: false,
  ArrowUp:    false,
  ArrowDown:  false
};

window.addEventListener('keydown', e=>{
  if(e.key in keys){
    keys[e.key] = true;
  }
});

window.addEventListener('keyup', e=>{
  if(e.key in keys){
    keys[e.key] = false;
  }
});

/* =========================
   토끼 타입 토글
   ========================= */
toggleBtn.addEventListener('click', ()=>{
  RABBIT.mode = (RABBIT.mode === 'red') ? 'mono' : 'red';
  toggleBtn.textContent = (RABBIT.mode === 'red') ? 'RED' : 'MONO';
});

/* =========================
   업데이트 & 그리기
   ========================= */
function update(dt){
  let dx = 0;
  let dy = 0;

  if(keys.ArrowLeft)  dx -= 1;
  if(keys.ArrowRight) dx += 1;
  if(keys.ArrowUp)    dy -= 1;
  if(keys.ArrowDown)  dy += 1;

  if(dx !== 0 || dy !== 0){
    const len = Math.sqrt(dx*dx + dy*dy) || 1;
    dx /= len;
    dy /= len;
    RABBIT.x += dx * RABBIT.speed * dt;
    RABBIT.y += dy * RABBIT.speed * dt;
  }

  // 화면 밖으로 안 나가게
  const margin = 16;
  RABBIT.x = Math.max(margin, Math.min(WIDTH - margin, RABBIT.x));
  RABBIT.y = Math.max(margin, Math.min(HEIGHT - margin, RABBIT.y));
}

function draw(){
  // 배경
  const grad = ctx.createLinearGradient(0,0,0,HEIGHT);
  grad.addColorStop(0,"#050505");
  grad.addColorStop(1,"#000000");
  ctx.fillStyle = grad;
  ctx.fillRect(0,0,WIDTH,HEIGHT);

  // 바닥 느낌 라인
  ctx.strokeStyle = "#111";
  ctx.lineWidth = 1;
  for(let y=HEIGHT*0.55; y<HEIGHT; y+=8){
    ctx.beginPath();
    ctx.moveTo(0,y);
    ctx.lineTo(WIDTH,y);
    ctx.stroke();
  }

  // 토끼 그림
  const size = 2; // 스케일
  const drawX = RABBIT.x - 4*size;
  const drawY = RABBIT.y - 6*size;

  if(RABBIT.mode === 'red'){
    drawRedRabbit(ctx, drawX, drawY, size);
  }else{
    drawMonoRabbit(ctx, drawX, drawY, size);
  }
}

/* =========================
   메인 루프
   ========================= */
function loop(timestamp){
  const dt = (timestamp - lastTime) / 1000;
  lastTime = timestamp;

  update(dt);
  draw();

  requestAnimationFrame(loop);
}

requestAnimationFrame(loop);
</script>
</body>
</html>
